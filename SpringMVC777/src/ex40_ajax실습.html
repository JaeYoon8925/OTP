<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

    <button id="btn">박스오피스 데이터 가져오기</button>
    <div id='movie-area'>
        <table border="1" width="800">
            <tr>
                <td>순위</td>
                <td>영화명</td>
                <td>개봉일</td>
            </tr>

        </table>

    </div>

    <script src='./js/jquery-3.6.4.min.js'></script>
    <script>

        // jQuery에서 지원하는 ajax 구현방법
        // $.ajax({
        //     // url : 데이터를 요철할 서버 경로
        //     ulr : '',
        //     // type : get / post
        //     type :'',
        //     // data : 서버에 보낼 데이터
        //     data : '',
        //     // dataType : 서버에 보낼 데이터
        //     dataType : '',
        //     success : '' ;
        //         //매개변수 : 서버로부터 응답받은 데이터
        //         console.log('요청 성공');
        //     error:function({
        //         console.log('요청 실패');
        //     });
        // });

        // Open API : Open Aplication Programming interface
        // 누구나 데이터를 사용할 수 있도록 공개된 API
        // 장점 : 시간고 비용이 많이 드는 기능을 직접 구현하지 않아도 유용헌 기능 데이터를 제공받음
        // 단점 : API를 서비하는 대부분의 회사는 사용자에게 인증키를 발급, 할당량을 부여
        //       할당량을 초과하면 요금 부여 가능성.

        // 공공데이터포털, 네이버,카카오 개발자센터, goodle Developpers 등등
        let movieUrl = 'http://kobis.or.kr/kobisopenapi/webservice/rest/boxoffice/searchDailyBoxOfficeList.json?key=f5eef3421c602c6cb7ea224104795888&targetDt=20120101';
        let btn = document.getElementById("btn");
        let movieArea = document.getElementById("movie-area");

        let getMovieList = function () {
            // 영화 정보를 비동기 통신으로 요청하는 로직 구현
            $.ajax({
                url: movieUrl,
                success: function (result) {
                    console.log('성공');
                    // console.log(result);
                    // console.log(result.boxOfficeResult);
                    console.log(result.boxOfficeResult.dailyBoxOfficeList);

                    let movieList = result.boxOfficeResult.dailyBoxOfficeList;

                    // 영화순위, 영화명, 개봉일 을 웹페이지에 출력.
                    render(movieList);

                    function render(movieList) {
                        let resultHTML =
                            `<table border="1" width="800">
                            <tr>
                                <td>순위</td>
                                <td>영화명</td>
                                <td>개봉일</td>
                                </tr>
                        `;



                        for (let i = 0; i < movieList.length; i++) {
                            $(movieArea.HTML).prepend(resultHTML);
                            resultHTML += `
                        
                        <tr>
                           <td>${movieList[i].rnum}</td>    
                           <td>>${movieList[i].movieNm}</td>   
                           <td>>${movieList[i].openDt}</td> 

                       </tr>`;


                        }
                        document.write(resultHTML);

                    }
                },
                error: function () {
                    console.log('실패');
                }


            })

        }
        btn.addEventListener("click", getMovieList);

    </script>
</body>

</html>